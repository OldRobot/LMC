<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Little Man Computer</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" type="text/css" href="lib/TextareaDecorator.css">
  <script src="lib/Parser.js" type="text/javascript"></script>
	<script src="lib/TextareaDecorator.js" type="text/javascript"></script>
  <script type="text/javascript" src="LMC.JS" charset="utf-8"></script>
</head>

<body>


<div id="codewindows">
    <div id="lmc">
     LMC 1
        <br>
    
    <!--- LMC 1   -------------------------------------------->
    <textarea id="code1" class="input">
      LDA TWENTY
      LOOP SUB ONE
      BRZ STOP
      BRA LOOP
      STOP OUT
      HLT
      ONE     DAT 001
      TWENTY  DAT 010
    </textarea>

      <br>
      <button type="button" name="button" onclick="reset1()"> compile and run</button>
      <br>
      <label>In:</label>
      <input id="input1" type="text">
      <br>
      <label>Out:</label>
      <input id="output1" type="text">
      <p id="acc1">ACC:</p>
<p id="pc1">PC:</p>
<p id="cir1">CIR:</p>
<p id="idel1">Idel: 100%</p>
     </div>
   </div>

   <!--- LMC 2  -------------------------------------------->
<div id="lmc">
    LMC 2
    <br>
<textarea id="code2" rows="30" cols="70">
  INP
  LDA TWENTY
  LOOP SUB ONE
  SUB ONE
  OUT
  BRZ STOP
  BRA LOOP
  STOP HLT
  ONE     DAT 001
  TWENTY  DAT 020
</textarea>

<br>
<button type="button" name="button" onclick="reset2()"> compile and run</button>
<br>
In:<input id="input2" type="text">
<br>
Out:<input id="output2" type="text">
<p id="acc2">ACC:</p>
<p id="pc2">PC:</p>
<p id="cir2">CIR:</p>
<p id="idel2">Idel: 100%</p>
</div>
</div>
<br>



  <script type="text/javascript">

//LMC 1
function reset1(){
  let str = document.getElementById("code1").value;
  let code =(assemeble(str, false));
  console.clear();
  console.log(code);
  lmc1 = new LMC(code,false,100,1);
  lmc1.setOutput("input2")
  lmc1.run();
}

//LMC 2
function reset2(){
  let str = document.getElementById("code2").value;
  let code =(assemeble(str, false));
  console.clear();
  lmc2 = new LMC(code,false,100,2);
  lmc2.run();
}

//code for the text decorator
var complied_code = [];

			// get element shortcut
			function $(e){ return document.getElementById(e); };
			// create the parser, case insensitive
			var parser = new Parser({
				whitespace: /\s+/,
				green: /start:|START:|end:|END:|loop:|LOOP:/,
				red: /add|ADD|sub|SUB|sta\w|STA|lda|LDA|bra|BRA|brz|BRZ|brp|BRP|inp|INP|out|OUT|htl|HTL|cob|COB|dat|DAT/,						
				blue: /0x[\dA-Fa-f]+|-?(\d+\.?\d*|\.\d+)/,
				indigo: /indigo/,
				comment: /\/\*([^\*]|\*[^\/])*(\*\/?)?|(\/\/|#)[^\r\n]*/,
				other: /\S+/ }, true );
			// wait for the page to finish loading before accessing the DOM
			window.onload = function(){
				// get the textarea
				var textarea = $('code1');
				// start the decorator
				decorator = new TextareaDecorator( textarea, parser );

				//get an array of the chars
        var textarea2 = $('code2');
				// start the decorator
				decorator = new TextareaDecorator( textarea2, parser );

			};

			

//end of code for the text decorator



  </script>

</body>

</html>
